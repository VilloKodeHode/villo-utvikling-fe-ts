"use client";

import { useTheme } from "next-themes";
import { useEffect, useState } from "react";
import { getCookie, setCookie } from "cookies-next";

export const ThemeSwitch: React.FC = () => {
  const { setTheme, theme } = useTheme();
  const [runAnimation, setRunAnimation] = useState<boolean>(false);
  const [hasMounted, setHasMounted] = useState<boolean>(false);

  useEffect(() => {
    setHasMounted(true);
  }, []);

  const toggleTheme = () => {
    setRunAnimation(true);
    if (theme === "light") {
      setTheme("dark");
      if (getCookie("acceptedCookies")) {
        setCookie("theme", "dark", {
          maxAge: 365 * 24 * 60 * 60, // Cookie expiration in seconds (1 year)expiration in seconds (30 days)
        });
      }
    } else {
      setTheme("light");
      if (getCookie("acceptedCookies")) {
        setCookie("theme", "light", {
          maxAge: 365 * 24 * 60 * 60, // Cookie expiration in seconds (1 year) expiration in seconds (30 days)
        });
      }
    }
  };

  if (!hasMounted) {
    return null;
  }

  return (
    // <ThemeSwitchButton onClick={toggleTheme} />
    <button
      className="relative cursor-pointer hover:scale-105 transition-all active:scale-90 w-[24px] h-[24px] grid-flow-col"
      onClick={toggleTheme}
    >
      <LightModeIcon
        className={` 
          ${
            runAnimation === false
              ? theme === "light"
                ? "animate-Theme-switch-slide-in"
                : "hidden"
              : ""
          }
           ${
             runAnimation
               ? theme === "light"
                 ? "animate-Theme-switch-slide-in"
                 : "animate-Theme-switch-slide-out"
               : ""
           }
          pointer-events-none w-8 h-auto absolute top-0`}
      />

      <DarkModeIcon
        className={` 
          ${
            runAnimation === false
              ? theme === "dark"
                ? "animate-Theme-switch-slide-in"
                : "hidden"
              : ""
          } ${
          runAnimation
            ? theme === "dark"
              ? "animate-Theme-switch-slide-in"
              : "animate-Theme-switch-slide-out"
            : ""
        } pointer-events-none w-8 h-auto absolute top-0`}
      />
    </button>
  );
};

export const DarkModeIcon = ({ className }) => {
  return (
    <svg
      className={`w-full h-full ${className}`}
      width="167"
      height="167"
      viewBox="0 0 167 167"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M149.167 2.56277C148.872 1.80773 148.357 1.15915 147.688 0.701891C147.019 0.244635 146.227 0 145.417 0C144.606 0 143.815 0.244635 143.146 0.701891C142.477 1.15915 141.961 1.80773 141.667 2.56277L138.083 11.6878C137.882 12.2035 137.578 12.6724 137.188 13.0652C136.798 13.4581 136.331 13.7664 135.817 13.9711L126.725 17.5711C125.972 17.871 125.327 18.3899 124.872 19.0606C124.417 19.7314 124.174 20.5232 124.174 21.3336C124.174 22.144 124.417 22.9358 124.872 23.6066C125.327 24.2773 125.972 24.7962 126.725 25.0961L135.817 28.6961C136.331 28.8981 136.798 29.2046 137.188 29.5961C137.579 29.9877 137.883 30.4559 138.083 30.9711L141.667 40.0878C143.017 43.5044 147.833 43.5044 149.167 40.0878L152.75 30.9628C152.953 30.4478 153.26 29.98 153.651 29.5886C154.042 29.1972 154.51 28.8906 155.025 28.6878L164.117 25.0878C164.87 24.7879 165.515 24.269 165.97 23.5982C166.425 22.9275 166.668 22.1357 166.668 21.3253C166.668 20.5148 166.425 19.7231 165.97 19.0523C165.515 18.3815 164.87 17.8627 164.117 17.5628L155.025 13.9628C154.509 13.759 154.041 13.4511 153.65 13.0582C153.258 12.6654 152.952 12.196 152.75 11.6794L149.167 2.56277ZM116.942 51.0878C116.647 50.3327 116.132 49.6841 115.463 49.2269C114.794 48.7696 114.002 48.525 113.192 48.525C112.381 48.525 111.59 48.7696 110.921 49.2269C110.252 49.6841 109.736 50.3327 109.442 51.0878L108.133 54.4128C107.932 54.927 107.626 55.3942 107.236 55.7856C106.846 56.1769 106.38 56.484 105.867 56.6878L102.55 58.0044C101.797 58.3043 101.152 58.8232 100.697 59.494C100.242 60.1647 99.9988 60.9565 99.9988 61.7669C99.9988 62.5774 100.242 63.3691 100.697 64.0399C101.152 64.7107 101.797 65.2295 102.55 65.5294L105.867 66.8378C106.908 67.2544 107.725 68.0711 108.133 69.1211L109.442 72.4461C110.783 75.8628 115.6 75.8628 116.942 72.4461L118.25 69.1128C118.452 68.5985 118.757 68.1313 119.147 67.7399C119.537 67.3486 120.003 67.0415 120.517 66.8378L123.833 65.5294C124.586 65.2295 125.232 64.7107 125.687 64.0399C126.142 63.3691 126.385 62.5774 126.385 61.7669C126.385 60.9565 126.142 60.1647 125.687 59.494C125.232 58.8232 124.586 58.3043 123.833 58.0044L120.517 56.6878C120.003 56.484 119.537 56.1769 119.147 55.7856C118.757 55.3942 118.452 54.927 118.25 54.4128L116.942 51.0794V51.0878Z"
        className="fill-dark-lavender"
      />
      <path
        d="M83.3333 166.671C129.358 166.671 166.667 129.363 166.667 83.3377C166.667 79.4794 160.883 78.8377 158.892 82.1461C154.644 89.1822 148.85 95.1594 141.95 99.625C135.05 104.09 127.224 106.927 119.065 107.92C110.906 108.913 102.629 108.037 94.8587 105.357C87.0889 102.677 80.0308 98.2638 74.219 92.452C68.4073 86.6403 63.9943 79.5822 61.3144 71.8123C58.6344 64.0425 57.7577 55.7646 58.7508 47.6058C59.7439 39.447 62.5806 31.6211 67.0461 24.7209C71.5116 17.8208 77.4888 12.0274 84.525 7.77939C87.8333 5.7794 87.1917 0.00439453 83.3333 0.00439453C37.3083 0.00439453 0 37.3127 0 83.3377C0 129.363 37.3083 166.671 83.3333 166.671Z"
        className="fill-dark-lavender"
      />
    </svg>
  );
};

export const LightModeIcon = ({ className }) => {
  return (
    <svg
      className={`w-full h-full ${className}`}
      width="200"
      height="200"
      viewBox="0 0 200 200"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g clipPath="url(#clip0_239_16)">
        <path
          d="M100 150C113.261 150 125.979 144.732 135.355 135.355C144.732 125.979 150 113.261 150 100C150 86.7392 144.732 74.0215 135.355 64.6447C125.979 55.2678 113.261 50 100 50C86.7392 50 74.0215 55.2678 64.6447 64.6447C55.2678 74.0215 50 86.7392 50 100C50 113.261 55.2678 125.979 64.6447 135.355C74.0215 144.732 86.7392 150 100 150ZM100 0C101.658 0 103.247 0.65848 104.419 1.83058C105.592 3.00269 106.25 4.5924 106.25 6.25V31.25C106.25 32.9076 105.592 34.4973 104.419 35.6694C103.247 36.8415 101.658 37.5 100 37.5C98.3424 37.5 96.7527 36.8415 95.5806 35.6694C94.4085 34.4973 93.75 32.9076 93.75 31.25V6.25C93.75 4.5924 94.4085 3.00269 95.5806 1.83058C96.7527 0.65848 98.3424 0 100 0ZM100 162.5C101.658 162.5 103.247 163.158 104.419 164.331C105.592 165.503 106.25 167.092 106.25 168.75V193.75C106.25 195.408 105.592 196.997 104.419 198.169C103.247 199.342 101.658 200 100 200C98.3424 200 96.7527 199.342 95.5806 198.169C94.4085 196.997 93.75 195.408 93.75 193.75V168.75C93.75 167.092 94.4085 165.503 95.5806 164.331C96.7527 163.158 98.3424 162.5 100 162.5ZM200 100C200 101.658 199.342 103.247 198.169 104.419C196.997 105.592 195.408 106.25 193.75 106.25H168.75C167.092 106.25 165.503 105.592 164.331 104.419C163.158 103.247 162.5 101.658 162.5 100C162.5 98.3424 163.158 96.7527 164.331 95.5806C165.503 94.4085 167.092 93.75 168.75 93.75H193.75C195.408 93.75 196.997 94.4085 198.169 95.5806C199.342 96.7527 200 98.3424 200 100ZM37.5 100C37.5 101.658 36.8415 103.247 35.6694 104.419C34.4973 105.592 32.9076 106.25 31.25 106.25H6.25C4.5924 106.25 3.00269 105.592 1.83058 104.419C0.65848 103.247 0 101.658 0 100C0 98.3424 0.65848 96.7527 1.83058 95.5806C3.00269 94.4085 4.5924 93.75 6.25 93.75H31.25C32.9076 93.75 34.4973 94.4085 35.6694 95.5806C36.8415 96.7527 37.5 98.3424 37.5 100ZM170.712 29.2875C171.884 30.4595 172.542 32.049 172.542 33.7063C172.542 35.3635 171.884 36.953 170.712 38.125L153.038 55.8125C152.456 56.3928 151.767 56.8529 151.008 57.1666C150.249 57.4804 149.436 57.6416 148.614 57.641C146.956 57.6398 145.366 56.9798 144.194 55.8062C143.613 55.2252 143.153 54.5354 142.84 53.7765C142.526 53.0176 142.365 52.2043 142.365 51.3831C142.366 49.7246 143.026 48.1344 144.2 46.9625L161.875 29.2875C163.047 28.1158 164.636 27.4576 166.294 27.4576C167.951 27.4576 169.54 28.1158 170.712 29.2875ZM55.8 144.2C56.9717 145.372 57.6299 146.961 57.6299 148.619C57.6299 150.276 56.9717 151.865 55.8 153.038L38.125 170.712C36.9462 171.851 35.3675 172.481 33.7287 172.467C32.09 172.452 30.5224 171.795 29.3636 170.636C28.2048 169.478 27.5475 167.91 27.5333 166.271C27.519 164.633 28.149 163.054 29.2875 161.875L46.9625 144.2C48.1345 143.028 49.724 142.37 51.3812 142.37C53.0385 142.37 54.628 143.028 55.8 144.2ZM170.712 170.712C169.54 171.884 167.951 172.542 166.294 172.542C164.636 172.542 163.047 171.884 161.875 170.712L144.2 153.038C143.062 151.859 142.432 150.28 142.446 148.641C142.46 147.003 143.117 145.435 144.276 144.276C145.435 143.117 147.003 142.46 148.641 142.446C150.28 142.432 151.859 143.062 153.038 144.2L170.712 161.875C171.884 163.047 172.542 164.636 172.542 166.294C172.542 167.951 171.884 169.54 170.712 170.712ZM55.8 55.8125C54.628 56.9842 53.0385 57.6424 51.3812 57.6424C49.724 57.6424 48.1345 56.9842 46.9625 55.8125L29.2875 38.125C28.6906 37.5485 28.2144 36.8588 27.8869 36.0963C27.5593 35.3338 27.3869 34.5136 27.3797 33.6838C27.3725 32.8539 27.5306 32.0309 27.8449 31.2628C28.1591 30.4947 28.6232 29.7969 29.21 29.21C29.7969 28.6232 30.4947 28.1591 31.2628 27.8449C32.0309 27.5306 32.8539 27.3725 33.6838 27.3797C34.5136 27.3869 35.3338 27.5593 36.0963 27.8869C36.8588 28.2144 37.5485 28.6906 38.125 29.2875L55.8 46.9625C56.382 47.5431 56.8438 48.2328 57.1589 48.9921C57.474 49.7514 57.6362 50.5654 57.6362 51.3875C57.6362 52.2096 57.474 53.0236 57.1589 53.7829C56.8438 54.5422 56.382 55.2319 55.8 55.8125Z"
          className="fill-light-violet"
        />
      </g>
      <defs>
        <clipPath id="clip0_239_16">
          <rect width="200" height="200" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );
};
